name: Auto Deploy

on:
  push:
    branches:
      - main
    tags:
      - 'v*'

jobs:
  deploy:
    name: Deploy on push to main or tag
    runs-on: ubuntu-latest
    steps:
      name: Auto Deploy

      on:
        push:
          branches:
            - main  # Trigger on push to the main branch

      jobs:
        deploy:
          runs-on: ubuntu-latest

          steps:
            # Step 1: Checkout the code
            - name: Checkout code
              uses: actions/checkout@v3

            # Step 2: Set up Node.js (Update with your required Node.js version)
            - name: Set up Node.js
              uses: actions/setup-node@v4
              with:
                node-version: '22.10.0'  # Recommended Node.js version >=22.10.0
                cache: 'npm'

            # Step 3: Install dependencies
            - name: Install dependencies
              run: npm install

            # Step 4: Build the project (optional, for TypeScript or similar builds)
            - name: Build project
              run: npm run build

            # Step 5: Add GitHub SSH Host Key
            - name: Add GitHub SSH Host Key
              run: |
                mkdir -p ~/.ssh
                ssh-keyscan github.com >> ~/.ssh/known_hosts

            # Step 6: Deploy the project (Define your own deployment commands)
            - name: Deploy to Server
              run: |
                # Add your deployment scripts/commands here
                echo "Deployment script goes here"
